{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}Dashboard - {{ site_title|default:"Django Admin" }}{% endblock %}

{% block branding %}
<h1 id="site-name">
    <a href="{% url 'admin:index' %}">{{ site_header|default:"Django Administration" }}</a>
</h1>
{% endblock %}

{% block content %}
<div class="dashboard">
    <h1>Campus Shop Dashboard</h1>
    
    <!-- Statistics Cards -->
    <div class="stats-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
        
        <!-- Products Stats -->
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #007bff;">
            <h3 style="margin: 0; color: #007bff;">Products</h3>
            <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">{{ stats.total_products }}</div>
            <div style="color: #6c757d; font-size: 14px;">
                <strong>{{ stats.active_products }}</strong> active
            </div>
        </div>
        
        <!-- Stores Stats -->
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #28a745;">
            <h3 style="margin: 0; color: #28a745;">Stores</h3>
            <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">{{ stats.total_stores }}</div>
            <div style="color: #6c757d; font-size: 14px;">
                <strong>{{ stats.approved_stores }}</strong> approved,
                <strong style="color: #ffc107;">{{ stats.pending_stores }}</strong> pending
            </div>
        </div>
        
        <!-- Categories Stats -->
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #6f42c1;">
            <h3 style="margin: 0; color: #6f42c1;">Categories</h3>
            <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">{{ stats.total_categories }}</div>
            <div style="color: #6c757d; font-size: 14px;">
                <strong>{{ stats.active_categories }}</strong> active
            </div>
        </div>
        
        <!-- Users Stats -->
        <div class="stat-card" style="background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #fd7e14;">
            <h3 style="margin: 0; color: #fd7e14;">Users</h3>
            <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">{{ stats.total_users }}</div>
            <div style="color: #6c757d; font-size: 14px;">
                <strong>{{ stats.seller_users }}</strong> sellers
            </div>
        </div>
        
    </div>
    
    <!-- Quick Actions -->
    <div style="margin: 30px 0;">
        <h2>Quick Actions</h2>
        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
            <a href="{% url 'admin:products_product_add' %}" 
               style="background: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">
                ‚ûï Add Product
            </a>
            <a href="{% url 'admin:stores_category_add' %}" 
               style="background: #28a745; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">
                üìÅ Add Category
            </a>
            <a href="{% url 'admin:stores_store_changelist' %}" 
               style="background: #ffc107; color: black; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">
                üè™ Manage Stores
            </a>
            <a href="{% url 'admin:accounts_user_changelist' %}" 
               style="background: #6c757d; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; display: inline-block;">
                üë• Manage Users
            </a>
        </div>
    </div>
    
    <!-- Recent Content -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
        
        <!-- Recent Products -->
        <div>
            <h2>Recent Products</h2>
            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;">
                {% if recent_products %}
                    {% for product in recent_products %}
                    <div style="padding: 12px; border-bottom: 1px solid #f1f3f4; display: flex; align-items: center; justify-content: between;">
                        <div style="flex: 1;">
                            <strong>{{ product.name }}</strong><br>
                            <small style="color: #6c757d;">{{ product.store.name }} ‚Ä¢ ‚Ç¶{{ product.price|floatformat:0 }}</small>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            {% if product.is_active %}
                                <span style="background: #d4edda; color: #155724; padding: 2px 8px; border-radius: 12px; font-size: 12px;">Active</span>
                            {% else %}
                                <span style="background: #f8d7da; color: #721c24; padding: 2px 8px; border-radius: 12px; font-size: 12px;">Inactive</span>
                            {% endif %}
                            {% if product.is_featured %}
                                <span style="background: #fff3cd; color: #856404; padding: 2px 8px; border-radius: 12px; font-size: 12px;">Featured</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div style="padding: 20px; text-align: center; color: #6c757d;">
                        No products yet. <a href="{% url 'admin:products_product_add' %}">Add your first product</a>
                    </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Pending Stores -->
        <div>
            <h2>Pending Store Applications</h2>
            <div style="background: white; border: 1px solid #dee2e6; border-radius: 8px; overflow: hidden;">
                {% if pending_stores %}
                    {% for store in pending_stores %}
                    <div style="padding: 12px; border-bottom: 1px solid #f1f3f4;">
                        <strong>{{ store.name }}</strong><br>
                        <small style="color: #6c757d;">{{ store.owner.email }} ‚Ä¢ {{ store.created_at|date:"M d, Y" }}</small><br>
                        <a href="{% url 'admin:stores_store_change' store.id %}" 
                           style="color: #007bff; text-decoration: none; font-size: 12px;">Review Application ‚Üí</a>
                    </div>
                    {% endfor %}
                {% else %}
                    <div style="padding: 20px; text-align: center; color: #6c757d;">
                        No pending applications
                    </div>
                {% endif %}
            </div>
        </div>
        
    </div>
    
    <!-- Management Tips -->
    <div style="background: #e7f3ff; padding: 20px; border-radius: 8px; margin: 30px 0;">
        <h3 style="margin-top: 0; color: #0056b3;">üí° Management Tips</h3>
        <ul style="margin: 0; padding-left: 20px;">
            <li><strong>Regular Monitoring:</strong> Check for pending store applications and product reviews weekly</li>
            <li><strong>Quality Control:</strong> Ensure all active products have proper descriptions and images</li>
            <li><strong>Featured Content:</strong> Update featured products and stores monthly to keep content fresh</li>
            <li><strong>User Engagement:</strong> Monitor user activity and respond to support requests promptly</li>
        </ul>
    </div>
    
</div>

<style>
.dashboard h1 {
    color: #333;
    border-bottom: 2px solid #007bff;
    padding-bottom: 10px;
}

.dashboard h2 {
    color: #555;
    margin-top: 0;
}

.stat-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}

@media (max-width: 768px) {
    .stats-grid {
        grid-template-columns: 1fr !important;
    }
    
    div[style*="grid-template-columns: 1fr 1fr"] {
        grid-template-columns: 1fr !important;
    }
}
</style>
{% endblock %}